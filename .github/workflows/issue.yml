---
  name: 🆘 Help wanted
  
  on:
    issues:
      types: [opened]
  
  jobs:
    # issue:
    #   name: 🔍 Get inputs
    #   if: ${{ contains(github.event.issue.labels.*.name, 'help wanted') }}
    #   runs-on: ubuntu-latest
    #   outputs:
    #     helpneededwith: ${{ steps.inputs.outputs.help_needed_with }}
    #     wiki: ${{ steps.inputs.outputs.documentation_page }}
    #   steps:
    #     - name: 📥 Get inputs
    #       id: inputs
    #       uses: drdonoso/issueform-get-inputs@main
    #       with:
    #         body: ${{ github.event.issue.body }}
      
    run:
      # needs: issue
      runs-on: ubuntu-latest
      name: 🚀 Run 
      permissions:
        issues: write
      env:
        AZURE_OPENAI_API_KEY: ${{ secrets.AZURE_OPENAI_API_KEY }}
        AZURE_OPENAI_ENDPOINT: ${{ vars.AZURE_OPENAI_API_ENDPOINT }}
        AZURE_OPENAI_API_INSTANCE_NAME: ${{ vars.AZURE_OPENAI_API_INSTANCE_NAME }}
        AZURE_OPENAI_API_VERSION: ${{ vars.AZURE_OPENAI_API_VERSION }}
      steps: 
        - name: 🚀 Start
          shell: bash
          id: start
          run: |
            echo "Running the workflow"
            body=$(echo "${{ github.event.issue.body }}" | tr -d '\n')
            echo "Help needed with: $body"
            echo "raw_body=${{ github.event.issue.body }}" >> $GITHUB_OUTPUT
        
        - name: Checkout
          uses: actions/checkout@v2
  
        - name: NPM Install
          run: npm install
        
        - name: Run script
          id: run
          run: node index.js "${{ steps.start.outputs.body }}"
  
        - name: Response issue
          uses: actions/github-script@v6
          with:
            script: |
              github.rest.issues.createComment({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                body: `### Answer: 
                ${{ steps.run.outputs.answer }}git
              });